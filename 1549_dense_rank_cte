/* Write your PL/SQL query statement below */

WITH RECENT_PROD AS(
    SELECT
    PRODUCT_ID,
    ORDER_ID,
    ORDER_DATE,
    DENSE_RANK() OVER(PARTITION BY PRODUCT_ID ORDER BY ORDER_DATE DESC) AS RANK
FROM
    ORDERS
ORDER BY
    PRODUCT_ID,
    ORDER_ID)
    

SELECT 
    P.PRODUCT_NAME,
    R.PRODUCT_ID,
    R.ORDER_ID,
    TO_CHAR(R.ORDER_DATE,'YYYY-MM-DD') AS ORDER_DATE
FROM
    RECENT_PROD R
JOIN
    PRODUCTS P
ON
    R.PRODUCT_ID = P.PRODUCT_ID
WHERE RANK = 1
ORDER BY
    P.PRODUCT_NAME ASC,
    R.PRODUCT_ID ASC,
    R.ORDER_ID ASC;
    
    


    
