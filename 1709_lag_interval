SELECT USER_ID,MAX(INTERVAL) as biggest_window
FROM(
SELECT USER_ID,
VISIT_DATE - LAG(VISIT_DATE,1,'2021-01-01') OVER(PARTITION BY USER_ID ORDER BY VISIT_DATE ASC ) AS INTERVAL
FROM USERVISITS) U
GROUP BY USER_ID
ORDER BY USER_ID;

