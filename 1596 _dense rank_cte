/* Write your PL/SQL query statement below */

WITH CUST_PROD AS(
SELECT
    CUSTOMER_ID,
    PRODUCT_ID,
    DENSE_RANK() OVER(PARTITION BY CUSTOMER_ID ORDER BY COUNT(PRODUCT_ID) DESC) AS FREQ_RANK
FROM
    ORDERS
GROUP BY 
    CUSTOMER_ID,
    PRODUCT_ID
ORDER BY 
    CUSTOMER_ID)


SELECT 
    C.CUSTOMER_ID,
    P.PRODUCT_ID,
    P.PRODUCT_NAME
FROM 
    CUST_PROD C
JOIN
    PRODUCTS P
ON
    C.PRODUCT_ID = P.PRODUCT_ID
WHERE C.FREQ_RANK = 1;
