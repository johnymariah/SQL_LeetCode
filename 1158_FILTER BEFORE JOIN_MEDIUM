
SELECT U.USER_ID as buyer_id,
    TO_CHAR(U.JOIN_DATE,'YYYY-MM-DD') AS join_date,
    count(O.ORDER_ID) AS orders_in_2019
FROM ORDERS O RIGHT JOIN USERS U
ON O.BUYER_ID = U.USER_ID
AND EXTRACT(YEAR FROM O.ORDER_DATE) = 2019
GROUP BY U.USER_ID,
    U.JOIN_DATE;
