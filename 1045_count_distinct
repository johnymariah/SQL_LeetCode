/* Write your PL/SQL query statement below */

-- get distinct count of all products from product table
-- get distinct product count of each customer in customer table
-- compare the counts, if equal return the customer id

SELECT CUSTOMER_ID
FROM CUSTOMER
GROUP BY CUSTOMER_ID
HAVING  COUNT( DISTINCT PRODUCT_KEY) =
(SELECT DISTINCT COUNT(PRODUCT_KEY) AS PROD_COUNT
 FROM PRODUCT);
 
 
 
 OR 

WITH CTE AS(
SELECT CUSTOMER_ID,
(SELECT DISTINCT COUNT(PRODUCT_KEY)
 FROM PRODUCT)  AS PROD_COUNT,
  COUNT(DISTINCT PRODUCT_KEY) AS CUST_PROD_COUNT
FROM CUSTOMER
GROUP BY CUSTOMER_ID)

SELECT CUSTOMER_ID
FROM CTE 
WHERE CTE.PROD_COUNT = CTE.CUST_PROD_COUNT;
